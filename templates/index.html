{% extends "base.html" %}
{% block content %}
<h3>Create New Work</h3>


<form action="{{ url_for('new_job') }}" method="post" class="mb-4">
  <div class="row g-2">
    <div class="col-md-4">
      <label class="form-label">Customer name</label>
      <input name="cust_name" class="form-control" placeholder="Customer name" required>
    </div>
    <div class="col-md-4">
      <label class="form-label">Phone</label>
      <input name="cust_phone" class="form-control" placeholder="Phone">
    </div>
    <div class="col-md-4">
      <label class="form-label">Address</label>
      <input name="cust_address" class="form-control" placeholder="Address">
    </div>

    <div class="col-md-4">
      <label class="form-label">Area / Locality</label>
      <input name="area" class="form-control" placeholder="Area">
    </div>
    <div class="col-md-4">
      <label class="form-label">TV Model / Device</label>
      <input name="tv_model" class="form-control" placeholder="e.g., Samsung 32&quot;">
    </div>
    <div class="col-md-4">
      <label class="form-label">Pickup Date</label>
      <input type="date" name="pickup_date" class="form-control">
    </div>

    <div class="col-12">
      <label class="form-label">Repair work / Problem</label>
      <textarea name="repair_work" class="form-control" rows="2"></textarea>
    </div>

    <div class="col-md-3">
      <label class="form-label">Charge (₹)</label>
      <input type="number" step="0.01" name="amount_charged" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">Expense (₹)</label>
      <input type="number" step="0.01" name="expense" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">Advance (₹)</label>
      <input type="number" step="0.01" name="advance_amount" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">Payment mode</label>
      <select name="payment_mode" class="form-select">
        <option>cash</option><option>upi</option><option>card</option><option>online</option>
      </select>
    </div>

    <div class="col-12">
      <label class="form-label">Note (optional)</label>
      <input name="note" class="form-control" placeholder="Any notes">
    </div>

    <div class="col-12 text-end">
      <button class="btn btn-primary mt-2">Create Work</button>
    </div>
  </div>
</form>

<hr>

<h4>Recent Works</h4>
{% if recent_jobs %}
  <ul class="list-group">
    {% for j in recent_jobs %}
      <li class="list-group-item">
        <div class="d-flex justify-content-between">
          <div>
            <strong>{{ j.customer.name }}</strong> — {{ j.tv_model or '-' }} <div class="small text-muted">{{ j.repair_work or '' }}</div>
          </div>
          <div class="text-end">
            <div>₹{{ '%.2f'|format(j.amount_charged or 0) }} <small class="text-muted"> / Profit ₹{{ '%.2f'|format(j.profit) }}</small></div>
            <div class="small"><a href="{{ url_for('job_detail', job_id=j.id) }}">Open</a></div>
          </div>
        </div>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <div class="text-muted">No Works yet.</div>
{% endif %}

{% endblock %}
